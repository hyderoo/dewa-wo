import{r as l,j as e,a as S,J as d}from"./app-Bs2T8Cel.js";import{B as M}from"./BaseLayout-B_SKP1-R.js";import{C as o}from"./circle-check-big-CyiEMgwB.js";import{C as u}from"./circle-x-BVBFCtNM.js";import{T as k}from"./triangle-alert-DF30lgZj.js";import{A as $}from"./arrow-left-BjysdjvJ.js";import{D as h,F as C}from"./file-text-CUkhy-jw.js";import{B as R}from"./building-BTeyIkLo.js";import{C as F}from"./credit-card-C7X7qjcX.js";import{C as P}from"./copy-Cj-b3sGt.js";import{C as L}from"./clock-CEO_fwKu.js";import"./createLucideIcon-CvzI4D8G.js";const V="font-cormorant font-semibold",Z=({order:t,payments:g,auth:B,toast:c})=>{const[T,j]=l.useState(!!c),[r,E]=l.useState(c||{type:"",message:""}),[f,D]=l.useState(null),[N,n]=l.useState(null),[m,p]=l.useState({});l.useEffect(()=>{if(c){j(!0);const s=setTimeout(()=>{j(!1)},5e3);return()=>clearTimeout(s)}},[c]);const v=s=>{if(!s)return[];try{const a=typeof s=="string"?JSON.parse(s):s;if(a.payment_instructions&&Array.isArray(a.payment_instructions))return a.payment_instructions}catch(a){console.error("Error parsing payment data:",a)}return[]},y=s=>s?{BCA:"Bank Central Asia",BNI:"Bank Negara Indonesia",BRI:"Bank Rakyat Indonesia",MANDIRI:"Bank Mandiri",PERMATA:"Bank Permata",CIMB:"CIMB Niaga"}[s.toUpperCase()]||s:"",w=(s,a)=>{navigator.clipboard.writeText(s),p({...m,[a]:!0}),setTimeout(()=>p({...m,[a]:!1}),2e3)},i=s=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(s),I=s=>{switch(s){case"verified":return"bg-green-100 text-green-800";case"pending":return"bg-yellow-100 text-yellow-800";case"rejected":return"bg-red-100 text-red-800";case"expired":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},b=s=>{switch(s){case"verified":return"Terverifikasi";case"pending":return"Menunggu Verifikasi";case"rejected":return"Ditolak";case"expired":return"Kadaluarsa";default:return s}},_=s=>{switch(s){case"verified":return e.jsx(o,{className:"h-5 w-5 text-green-600"});case"pending":return e.jsx(L,{className:"h-5 w-5 text-yellow-600"});case"rejected":return e.jsx(u,{className:"h-5 w-5 text-red-600"});case"expired":return e.jsx(k,{className:"h-5 w-5 text-gray-600"});default:return null}},x=s=>{if(!s)return"-";const a=new Date(s);return new Intl.DateTimeFormat("id-ID",{day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(a)};return e.jsxs(e.Fragment,{children:[e.jsx(S,{title:`Riwayat Pembayaran: ${t.order_number}`}),e.jsx(M,{auth:B,children:e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[T&&e.jsx("div",{className:`fixed top-4 right-4 z-50 max-w-md rounded-lg shadow-lg p-4 ${r.type==="success"?"bg-green-100 border border-green-200":r.type==="error"?"bg-red-100 border border-red-200":"bg-blue-100 border border-blue-200"}`,children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:r.type==="success"?e.jsx(o,{className:"h-5 w-5 text-green-500"}):r.type==="error"?e.jsx(u,{className:"h-5 w-5 text-red-500"}):e.jsx(k,{className:"h-5 w-5 text-blue-500"})}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:`text-sm font-medium ${r.type==="success"?"text-green-800":r.type==="error"?"text-red-800":"text-blue-800"}`,children:r.message})}),e.jsx("div",{className:"ml-auto pl-3",children:e.jsx("div",{className:"-mx-1.5 -my-1.5",children:e.jsx("button",{onClick:()=>j(!1),className:"inline-flex rounded-md p-1.5 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500",children:e.jsx(u,{className:"h-5 w-5 text-gray-500"})})})})]})}),N&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50",onClick:()=>n(null),children:e.jsxs("div",{className:"bg-white p-2 rounded-lg max-w-3xl max-h-[90vh] w-full",onClick:s=>s.stopPropagation(),children:[e.jsx("div",{className:"flex justify-end mb-2",children:e.jsx("button",{onClick:()=>n(null),className:"p-1 bg-gray-200 rounded-full",children:e.jsx(u,{className:"w-5 h-5 text-gray-700"})})}),e.jsx("div",{className:"overflow-auto max-h-[80vh]",children:e.jsx("img",{src:N,alt:"Bukti Pembayaran",className:"mx-auto max-w-full object-contain"})})]})}),e.jsx("div",{className:"mb-6",children:e.jsxs(d,{href:route("orders"),className:"inline-flex items-center text-gray-600 hover:text-gray-900",children:[e.jsx($,{className:"h-4 w-4 mr-1"}),"Kembali ke Daftar Pesanan"]})}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-purple-500 to-indigo-500 p-6 text-white",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between items-start sm:items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:`${V} text-2xl font-bold`,children:"Riwayat Pembayaran"}),e.jsxs("p",{className:"text-white/80",children:["Order #",t.order_number," (",t.client_name,")"]})]}),e.jsxs("div",{className:"mt-4 sm:mt-0 sm:text-right",children:[e.jsx("p",{className:"text-white/80",children:"Total Dibayar"}),e.jsx("p",{className:"text-2xl font-bold",children:i(t.paid_amount)}),e.jsxs("p",{className:"text-white/80",children:["dari ",i(t.price)," (",Math.round(t.paid_amount/t.price*100),"%)"]})]})]})}),e.jsxs("div",{className:"p-4 bg-gray-50 border-b border-gray-200",children:[e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:e.jsx("div",{className:"bg-purple-600 h-3 rounded-full",style:{width:`${Math.min(Math.round(t.paid_amount/t.price*100),100)}%`}})}),e.jsxs("div",{className:"flex justify-between text-sm text-gray-500 mt-1",children:[e.jsx("span",{children:"Rp 0"}),e.jsxs("span",{children:[Math.round(t.paid_amount/t.price*100),"%"]}),e.jsx("span",{children:i(t.price)})]})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Daftar Pembayaran"}),t.remaining_amount>0&&e.jsxs(d,{href:route("payment.detail",t.id),className:"inline-flex items-center px-4 py-2 bg-purple-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-purple-700 focus:outline-none",children:[e.jsx(h,{className:"h-4 w-4 mr-1"}),"Tambah Pembayaran"]})]}),g&&g.length>0?e.jsx("div",{className:"space-y-4",children:g.map(s=>e.jsxs("div",{className:`border ${s.status==="rejected"?"border-red-200":"border-gray-200"} rounded-lg overflow-hidden`,children:[e.jsxs("div",{className:`p-4 flex justify-between items-center cursor-pointer hover:bg-gray-50 ${s.status==="rejected"?"bg-red-50":""}`,onClick:()=>D(f===s.id?null:s.id),children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`p-3 rounded-full mr-3 ${s.status==="verified"?"bg-green-100":s.status==="pending"?"bg-yellow-100":s.status==="rejected"?"bg-red-100":"bg-gray-100"}`,children:s.payment_method==="bank_transfer"?e.jsx(R,{className:"h-5 w-5 text-gray-600"}):s.payment_method==="virtual_account"?e.jsx(F,{className:"h-5 w-5 text-blue-600"}):_(s.status)}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"font-medium text-gray-900",children:s.formatted_amount||i(s.amount)}),e.jsx("span",{className:`ml-2 px-2 py-1 rounded-full text-xs font-medium ${I(s.status)}`,children:b(s.status)})]}),e.jsxs("p",{className:"text-sm text-gray-500",children:[s.payment_type==="down_payment"?"Uang Muka":s.payment_type==="installment"?"Cicilan":"Pelunasan"," -",s.payment_method==="bank_transfer"?e.jsxs("span",{className:"font-medium",children:[" Transfer Bank ",s.bank_code]}):s.payment_method==="virtual_account"?e.jsxs("span",{className:"font-medium",children:[" Virtual Account ",s.bank_code]}):s.payment_method]}),s.payment_method==="virtual_account"&&s.va_number&&s.status==="pending"&&e.jsxs("div",{className:"mt-1 flex items-center",children:[e.jsxs("p",{className:"text-xs text-blue-600 font-medium",children:["VA: ",s.va_number]}),e.jsx("button",{onClick:a=>{a.stopPropagation(),w(s.va_number,`va-${s.id}`)},className:"ml-2 p-1 bg-gray-100 rounded-md hover:bg-gray-200 transition",children:m[`va-${s.id}`]?e.jsx(o,{className:"h-3 w-3 text-green-600"}):e.jsx(P,{className:"h-3 w-3 text-gray-600"})})]})]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("p",{className:"text-sm text-gray-500 mr-3",children:x(s.created_at)}),s.payment_proof&&e.jsx("button",{onClick:a=>{a.stopPropagation(),n(s.payment_proof_url)},className:"px-3 py-1 bg-blue-600 text-white text-xs rounded-md hover:bg-blue-700",children:"Bukti"}),s.payment_method==="virtual_account"&&s.status==="pending"&&e.jsx(d,{href:route("payment.status",s.id),onClick:a=>a.stopPropagation(),className:"px-3 py-1 ml-2 bg-indigo-600 text-white text-xs rounded-md hover:bg-indigo-700",children:"Detail VA"})]})]}),s.status==="rejected"&&s.note&&e.jsx("div",{className:"px-4 py-3 bg-red-50 border-t border-red-200 flex items-start",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-red-800",children:"Alasan Penolakan:"}),e.jsx("p",{className:"text-sm text-red-700",children:s.note})]})}),f===s.id&&e.jsx("div",{className:"p-4 bg-gray-50 border-t border-gray-200",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Detail Pembayaran"}),e.jsx("div",{className:"bg-white p-3 rounded-lg border border-gray-200",children:e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"ID Pembayaran"}),e.jsx("p",{className:"font-medium",children:s.id})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Tanggal"}),e.jsx("p",{className:"font-medium",children:x(s.created_at)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Metode"}),e.jsx("p",{className:"font-medium",children:s.payment_method==="bank_transfer"?"Transfer Bank":s.payment_method==="virtual_account"?"Virtual Account":s.payment_method})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Status"}),e.jsx("p",{className:"font-medium",children:b(s.status)})]}),s.bank_code&&e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Bank"}),e.jsx("p",{className:"font-medium",children:y(s.bank_code)})]}),s.transaction_id&&e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Transaction ID"}),e.jsx("p",{className:"font-medium truncate",children:s.transaction_id})]}),s.va_number&&e.jsxs("div",{className:"col-span-2",children:[e.jsx("p",{className:"text-gray-500",children:"Virtual Account"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("p",{className:"font-medium mr-2",children:s.va_number}),e.jsx("button",{onClick:()=>w(s.va_number,`va-detail-${s.id}`),className:"p-1 bg-gray-100 rounded-md hover:bg-gray-200 transition",children:m[`va-detail-${s.id}`]?e.jsx(o,{className:"h-4 w-4 text-green-600"}):e.jsx(P,{className:"h-4 w-4 text-gray-600"})})]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Lakukan pembayaran melalui ",y(s.bank_code)," Mobile/Internet Banking"]})]}),s.payment_method==="virtual_account"&&s.payment_data&&e.jsxs("div",{className:"md:col-span-2 mt-2",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Petunjuk Pembayaran"}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-100",children:[e.jsx("ol",{className:"list-decimal list-inside space-y-2",children:v(s.payment_data).map((a,A)=>e.jsx("li",{className:"text-sm text-blue-800",children:a.instruction},A))}),v(s.payment_data).length===0&&e.jsx("p",{className:"text-sm text-gray-500 italic",children:"Tidak ada petunjuk pembayaran khusus yang tersedia."})]})]}),s.expiry_time&&e.jsxs("div",{className:"col-span-2",children:[e.jsx("p",{className:"text-gray-500",children:"Kadaluarsa Pada"}),e.jsx("p",{className:"font-medium",children:x(s.expiry_time)})]})]})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Status"}),e.jsxs("div",{className:"bg-white p-3 rounded-lg border border-gray-200",children:[e.jsxs("div",{className:"flex items-center mb-3",children:[e.jsx("div",{className:`p-2 rounded-full mr-2 ${s.status==="verified"?"bg-green-100":s.status==="pending"?"bg-yellow-100":s.status==="rejected"?"bg-red-100":"bg-gray-100"}`,children:_(s.status)}),e.jsx("span",{className:"font-medium",children:b(s.status)})]}),s.status==="verified"&&s.verified_at&&e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsxs("p",{children:["Diverifikasi pada: ",x(s.verified_at)]}),s.verified_by_name&&e.jsxs("p",{children:["Diverifikasi oleh: ",s.verified_by_name]})]}),s.status==="rejected"&&s.note&&e.jsxs("div",{className:"mt-2 p-3 bg-red-50 rounded-lg border border-red-200",children:[e.jsx("p",{className:"font-medium text-red-800 text-sm",children:"Alasan Penolakan:"}),e.jsx("p",{className:"text-sm text-red-700 mt-1",children:s.note})]}),s.status==="pending"&&s.payment_method==="virtual_account"&&e.jsxs("div",{className:"mt-2",children:[e.jsx(d,{href:route("payment.status",s.id),className:"inline-flex items-center px-3 py-2 bg-blue-600 text-white text-sm rounded-md hover:bg-blue-700 w-full justify-center",children:"Cek Status Pembayaran"}),e.jsx("div",{className:"text-sm text-gray-500 italic mt-2",children:"Pembayaran virtual account akan otomatis diverifikasi oleh sistem."})]})]})]}),s.payment_method==="bank_transfer"&&s.payment_proof&&e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Bukti Pembayaran"}),e.jsxs("div",{className:"bg-white p-3 rounded-lg border border-gray-200",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("img",{src:s.payment_proof_url,alt:"Bukti Pembayaran",className:"max-h-64 rounded-lg object-contain cursor-pointer",onClick:()=>n(s.payment_proof_url)})}),e.jsx("div",{className:"flex justify-center mt-3",children:e.jsx("button",{onClick:()=>n(s.payment_proof_url),className:"inline-flex items-center text-sm text-blue-600 hover:text-blue-800",children:"Lihat Gambar Lengkap"})})]})]})]})})]},s.id))}):e.jsxs("div",{className:"bg-gray-50 rounded-lg p-8 text-center",children:[e.jsx("div",{className:"mx-auto h-12 w-12 flex items-center justify-center rounded-full bg-gray-100",children:e.jsx(C,{className:"h-6 w-6 text-gray-400"})}),e.jsx("h3",{className:"mt-2 text-lg font-medium text-gray-900",children:"Belum Ada Pembayaran"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Belum ada catatan pembayaran untuk pesanan ini."}),e.jsx("div",{className:"mt-6",children:e.jsxs(d,{href:route("payment.detail",t.id),className:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-purple-600 hover:bg-purple-700 focus:outline-none",children:[e.jsx(h,{className:"-ml-1 mr-2 h-5 w-5"}),"Buat Pembayaran"]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mt-8",children:[e.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-full",children:e.jsx(h,{className:"h-5 w-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 text-sm",children:"Total Dibayar"}),e.jsx("p",{className:"font-medium",children:i(t.paid_amount)})]})]})}),e.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-yellow-100 rounded-full",children:e.jsx(h,{className:"h-5 w-5 text-yellow-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 text-sm",children:"Sisa Pembayaran"}),e.jsx("p",{className:"font-medium",children:i(t.remaining_amount)})]})]})}),e.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-full",children:e.jsx(C,{className:"h-5 w-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 text-sm",children:"Status Pembayaran"}),e.jsx("p",{className:"font-medium",children:t.is_fully_paid?"Lunas":"Belum Lunas"})]})]})})]})]})]})]})})})]})};export{Z as default};
