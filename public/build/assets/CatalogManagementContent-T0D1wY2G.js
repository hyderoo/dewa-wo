import{q as oe,r,S as ne,j as t}from"./app-Bj-2ttWe.js";import{T as le}from"./Toast-0AKSzmFv.js";import ie from"./CatalogCard-CzlufMJF.js";import me from"./CatalogFormModal-C3AQZls9.js";import ce from"./DeleteCatalogConfirmationModal-DP3UTG3n.js";import de from"./CatalogFilterBar-83bUdGiI.js";import ue from"./CatalogFilterStatusBar-o8By3m1C.js";import{P as L}from"./plus-C9N-fGdW.js";import{C as pe}from"./circle-alert-DbwOTSu0.js";import"./pen-0WvtQCWi.js";import"./createLucideIcon-Q6M-lg5u.js";import"./trash-2-BsVUv4IH.js";import"./CatalogForm-BShiH4Rz.js";import"./x-P4FUM78l.js";import"./upload-BYAEokgQ.js";import"./search-CxmgQfz-.js";import"./funnel-D9_HO87W.js";import"./refresh-cw-BcE-aV5D.js";const Pe=()=>{const{catalogs:u,toast:c}=oe().props,[S,A]=r.useState([]),[p,I]=r.useState([]),[n,C]=r.useState(""),[l,f]=r.useState("all"),[B,m]=r.useState(!1),[g,v]=r.useState(null),[x,N]=r.useState(""),[O,h]=r.useState(!1),[T,R]=r.useState({type:"",message:""}),[U,b]=r.useState(null),[H,_]=r.useState(!1),[V,D]=r.useState(null),[K,w]=r.useState(""),[q,y]=r.useState(""),j=[{value:"all-in-one",label:"Paket Lengkap"},{value:"decoration",label:"Dekorasi"},{value:"documentation",label:"Dokumentasi"}];r.useEffect(()=>{u&&A(u)},[u]),r.useEffect(()=>{let e=S;n&&(e=e.filter(a=>a.name.toLowerCase().includes(n.toLowerCase())||a.description.toLowerCase().includes(n.toLowerCase()))),l!=="all"&&(e=e.filter(a=>a.type===l)),I(e)},[S,n,l]),r.useEffect(()=>{if(c){R({type:c.type,message:c.message}),h(!0);const e=setTimeout(()=>{h(!1)},5e3);return()=>clearTimeout(e)}},[c]);const{data:o,setData:i,post:F,processing:W,errors:k,reset:z,clearErrors:M,setError:G}=ne({name:"",description:"",min_price:"",max_price:"",type:"all-in-one",features:[],image:null,_method:""}),d=e=>{if(!e)return"";const a=e.toString().replace(/\D/g,"");return a===""?"":new Intl.NumberFormat("id-ID").format(a)},P=e=>e&&parseInt(e.replace(/\D/g,""),10)||0,J=e=>{const a=d(e.target.value);w(a);const s=P(a);i("min_price",s),k.min_price&&M("min_price")},Q=e=>{const a=d(e.target.value);y(a);const s=P(a);i("max_price",s),k.max_price&&M("max_price")},E=()=>{v(null),z(),i({name:"",description:"",min_price:"",max_price:"",type:"all-in-one",features:[],image:null,_method:""}),w(""),y(""),b(null),m(!0)},X=e=>{v(e);const a=e.price[0]||0,s=e.price[1]||0;w(d(a.toString())),y(d(s.toString())),i({name:e.name,description:e.description,min_price:Number(a),max_price:Number(s),type:e.type,features:e.features||[],image:null,_method:"PUT"}),b(e.image),m(!0)},Y=()=>{x.trim()&&(i({...o,features:[...o.features,x.trim()]}),N(""))},Z=e=>{i({...o,features:o.features.filter((a,s)=>s!==e)})},$=e=>{const a=e.target.files[0];if(a){const s=new FileReader;s.onload=se=>{b(se.target.result)},s.readAsDataURL(a),i("image",a)}},ee=()=>{let e=!0;const a=Number(o.min_price),s=Number(o.max_price);return a>s&&(G("max_price","Harga maksimum harus lebih besar dari harga minimum"),e=!1),e},te=e=>{e.preventDefault(),ee()&&(g?F(route("admin.catalogs.update",g.id),{...o,_method:"PUT",features:o.features||[],onSuccess:()=>{m(!1)},onError:a=>{console.error("Update errors:",a)},forceFormData:!0}):F(route("admin.catalogs.store"),{onSuccess:()=>{m(!1)},onError:a=>{console.error("Create errors:",a)},forceFormData:!0}))},ae=e=>{D(e),_(!0)},re=()=>{_(!1),D(null)};return t.jsxs("div",{className:"min-h-screen bg-gray-50 py-12 px-4 sm:px-6 lg:px-8 text-gray-600",children:[O&&t.jsx(le,{type:T.type,message:T.message,onClose:()=>h(!1)}),t.jsx(ce,{isOpen:H,onClose:re,catalog:V}),t.jsx(me,{isOpen:B,selectedService:g,data:o,setData:i,errors:k,minPriceFormatted:K,maxPriceFormatted:q,handleMinPriceChange:J,handleMaxPriceChange:Q,serviceTypes:j,currentFeature:x,setCurrentFeature:N,handleAddFeature:Y,handleRemoveFeature:Z,previewImage:U,handleImageChange:$,processing:W,handleSubmit:te,onClose:()=>m(!1)}),t.jsx("div",{className:"max-w-7xl mx-auto",children:t.jsxs("div",{className:"bg-white shadow-xl rounded-2xl overflow-hidden",children:[t.jsxs("div",{className:"bg-gradient-to-r from-pink-500 to-rose-500 p-6 md:p-8",children:[t.jsx("h1",{className:"font-cormorant text-3xl md:text-4xl font-light text-white text-center tracking-wide",children:"Manajemen Katalog Layanan"}),t.jsx("p",{className:"text-center text-white/80 mt-2 max-w-2xl mx-auto",children:"Kelola paket dan layanan pernikahan untuk ditampilkan kepada klien"})]}),t.jsx("div",{className:"p-4 md:p-6 bg-gray-50 border-b border-gray-200",children:t.jsxs("div",{className:"flex flex-col md:flex-row justify-between space-y-4 md:space-y-0",children:[t.jsxs("button",{onClick:E,className:"w-full md:w-auto bg-pink-600 text-white px-6 py-3 rounded-lg hover:bg-pink-700 transition-colors focus:outline-none focus:ring-2 focus:ring-pink-500 focus:ring-offset-2",children:[t.jsx(L,{className:"w-4 h-4 mr-2 inline-block"}),"Tambah Layanan Baru"]}),t.jsx(de,{searchTerm:n,setSearchTerm:C,selectedType:l,setSelectedType:f,serviceTypes:j})]})}),(l!=="all"||n)&&t.jsx(ue,{selectedType:l,setSelectedType:f,filteredServicesCount:p.length}),t.jsx("div",{className:"p-6 md:p-8",children:t.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6",children:p.length>0?p.map(e=>t.jsx(ie,{service:e,serviceTypes:j,onEdit:X,onDelete:ae},e.id)):t.jsxs("div",{className:"col-span-1 lg:col-span-2 xl:col-span-3 flex flex-col items-center justify-center bg-white rounded-lg shadow p-8",children:[t.jsx(pe,{className:"h-12 w-12 text-gray-400 mb-4"}),t.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-1",children:"Tidak ada layanan ditemukan"}),t.jsx("p",{className:"text-gray-500 text-center mb-4",children:n||l!=="all"?"Tidak ada layanan yang cocok dengan filter Anda.":"Silakan tambahkan layanan baru untuk memulai."}),t.jsxs("div",{className:"mt-6 flex justify-center space-x-3",children:[(n||l!=="all")&&t.jsxs("button",{onClick:()=>{C(""),f("all")},className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:[t.jsx("svg",{className:"-ml-1 mr-2 h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Tampilkan Semua"]}),t.jsxs("button",{onClick:E,className:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-pink-600 hover:bg-pink-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-pink-500",children:[t.jsx(L,{className:"-ml-1 mr-2 h-4 w-4"}),"Tambah Layanan Baru"]})]})]})})})]})})]})};export{Pe as default};
