import{q as J,r as o,S as X,j as e,f as H}from"./app-Bj-2ttWe.js";import{T as K}from"./Toast-0AKSzmFv.js";import Q from"./DeleteBankConfirmationModal-RnoRTUSc.js";import{B as D}from"./building-C3Qd_UEZ.js";import{X as F}from"./x-P4FUM78l.js";import{U as V}from"./upload-BYAEokgQ.js";import{S as W}from"./save-Dex4yvPJ.js";import"./trash-2-BsVUv4IH.js";import"./createLucideIcon-Q6M-lg5u.js";import"./circle-alert-DbwOTSu0.js";const ie=()=>{const{banks:j,toast:m}=J().props,w=o.useRef(null),[U,p]=o.useState(!1),[i,O]=o.useState(null),[P,u]=o.useState(!1),[_,v]=o.useState({type:"",message:""}),[k,h]=o.useState(null),[C,f]=o.useState(!1),[$,B]=o.useState(!1),[I,S]=o.useState(null),{data:t,setData:x,post:A,processing:E,errors:a,reset:T,clearErrors:M,setError:d}=X({name:"",code:"",account_number:"",account_name:"",branch:"",logo:null,_logo:"",is_active:!0,description:"",_method:"PUT"});o.useEffect(()=>{if(m){v({type:m.type,message:m.message}),m.type==="success"&&(p(!1),T(),h(null)),f(!1),u(!0);const s=setTimeout(()=>{u(!1)},5e3);return()=>clearTimeout(s)}},[m]);const l=s=>{const{name:c,value:n,type:g,checked:r,files:y}=s.target;if(g==="file"){if(y&&y.length>0){const b=y[0];if(!["image/jpeg","image/png","image/gif","image/jpg"].includes(b.type)){d("logo","Please select a valid image file (JPEG, PNG, GIF)");return}if(b.size>2*1024*1024){d("logo","Image size should be less than 2MB");return}M("logo"),x("logo",b);const L=URL.createObjectURL(b);h(L)}}else g==="checkbox"?x(c,r):x(c,n)},N=(s=null)=>{O(s),M(),s?(x({name:s.name,code:s.code,account_number:s.account_number,account_name:s.account_name,branch:s.branch||"",logo:null,_logo:s.logo||"/bank-placeholder.jpg",is_active:s.is_active||!0,description:s.description||"",_method:"PUT"}),h(s.logo)):(T(),x({name:"",code:"",account_number:"",account_name:"",branch:"",logo:null,_logo:"",is_active:!0,description:"",_method:""}),h(null)),p(!0)},q=s=>{s.preventDefault();let c=!1;if(t.name.trim()||(d("name","Bank name is required"),c=!0),t.code.trim()||(d("code","Bank code is required"),c=!0),t.account_number.trim()||(d("account_number","Account number is required"),c=!0),t.account_name.trim()||(d("account_name","Account name is required"),c=!0),c)return;const n=new FormData;n.append("name",t.name),n.append("code",t.code),n.append("account_number",t.account_number),n.append("account_name",t.account_name),n.append("branch",t.branch||""),n.append("is_active",t.is_active?"1":"0"),n.append("description",t.description||""),t.logo instanceof File&&(console.log("Appending logo file to form data:",t.logo.name),n.append("logo",t.logo)),i&&n.append("_method","PUT"),console.log("Form data entries:");for(let r of n.entries())console.log(r[0]+": "+(r[1]instanceof File?r[1].name:r[1]));f(!0);const g={preserveState:!1,preserveScroll:!0,forceFormData:!0,onSuccess:()=>{f(!1)},onError:r=>{f(!1),console.error("Form submission errors:",r),r.logo&&(v({type:"error",message:r.logo}),u(!0))}};A(i?route("admin.banks.update",i.id):route("admin.banks.store"),n,g)},z=s=>{S(s),B(!0)},R=()=>{B(!1),S(null)},G=s=>{H.patch(route("admin.banks.toggle-active",s.id),{},{preserveScroll:!0,onError:()=>{v({type:"error",message:"Failed to toggle bank status"}),u(!0)}})};return e.jsxs("div",{className:"min-h-screen bg-gray-50 py-12 px-4 sm:px-6 lg:px-8 text-gray-600",children:[P&&e.jsx(K,{type:_.type,message:_.message,onClose:()=>u(!1)}),e.jsx(Q,{isOpen:$,onClose:R,bank:I}),e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsxs("div",{className:"bg-white shadow-xl rounded-2xl overflow-hidden",children:[e.jsxs("div",{className:"bg-gradient-to-r from-blue-500 to-indigo-600 p-6 md:p-8",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-semibold text-white text-center tracking-wide",children:"Bank Account Management"}),e.jsx("p",{className:"text-center text-white/80 mt-2 max-w-2xl mx-auto",children:"Manage your bank accounts efficiently and professionally"})]}),e.jsx("div",{className:"p-4 md:p-6 bg-gray-50 border-b border-gray-200",children:e.jsx("button",{onClick:()=>N(),className:"w-full md:w-auto bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:"+ Add New Bank Account"})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 p-6 md:p-8",children:j&&j.length>0?j.map(s=>e.jsx("div",{className:`bg-white border ${s.is_active?"border-blue-500 ring-2 ring-blue-300":"border-gray-200"} rounded-xl shadow-md hover:shadow-lg transition-shadow overflow-hidden`,children:e.jsxs("div",{className:"p-6",children:[s.is_active&&e.jsx("div",{className:"mb-2",children:e.jsx("span",{className:"bg-green-100 text-green-800 text-xs font-medium px-2.5 py-0.5 rounded",children:"Active Bank"})}),e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("img",{src:s.logo||"/bank-placeholder.jpg",alt:s.name,className:`w-16 h-16 rounded-full object-cover mr-4 border-2 ${s.is_active?"border-blue-500":"border-gray-200"}`}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:s.name}),e.jsx("p",{className:"text-sm text-gray-500",children:s.code})]})]}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsx("div",{className:"flex items-center",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Account Number"}),e.jsx("p",{className:"font-medium",children:s.account_number})]})}),e.jsx("div",{className:"flex items-center",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Account Name"}),e.jsx("p",{className:"font-medium",children:s.account_name})]})}),s.branch&&e.jsx("div",{className:"flex items-center",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Branch"}),e.jsx("p",{className:"font-medium",children:s.branch})]})})]}),e.jsxs("div",{className:"flex justify-between items-center border-t border-gray-100 pt-4",children:[e.jsx("button",{onClick:()=>G(s),className:`px-3 py-1 rounded-full text-sm ${s.is_active?"bg-green-100 text-green-800 hover:bg-green-200":"bg-gray-100 text-gray-800 hover:bg-gray-200"}`,children:s.is_active?"Active":"Inactive"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>N(s),className:"text-blue-500 hover:text-blue-700 text-sm",children:"Edit"}),e.jsx("button",{onClick:()=>z(s),className:"text-red-500 hover:text-red-700 text-sm",children:"Delete"})]})]})]})},s.id)):e.jsxs("div",{className:"col-span-full text-center py-12",children:[e.jsx(D,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mt-2 text-sm font-semibold text-gray-900",children:"No banks added"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Get started by adding a new bank account"}),e.jsx("div",{className:"mt-6",children:e.jsx("button",{onClick:()=>N(),className:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"+ Add New Bank"})})]})})]})}),U&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md flex flex-col max-h-[90vh]",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200 sticky top-0 bg-white rounded-t-xl z-10 flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:i?"Edit Bank Account":"Add New Bank Account"}),e.jsx("button",{onClick:()=>p(!1),className:"text-gray-500 hover:text-gray-700",children:e.jsx(F,{className:"h-6 w-6"})})]}),e.jsx("div",{className:"p-6 overflow-y-auto flex-1",children:e.jsxs("form",{id:"bankForm",onSubmit:q,encType:"multipart/form-data",className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Bank Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",name:"name",value:t.name,onChange:l,className:`w-full px-3 py-2 border ${a.name?"border-red-500":"border-gray-300"} rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500`,placeholder:"Enter bank name"}),a.name&&e.jsx("div",{className:"text-red-500 text-sm mt-1",children:a.name})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Bank Code ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",name:"code",value:t.code,onChange:l,className:`w-full px-3 py-2 border ${a.code?"border-red-500":"border-gray-300"} rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500`,placeholder:"Enter bank code"}),a.code&&e.jsx("div",{className:"text-red-500 text-sm mt-1",children:a.code})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Account Number ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",name:"account_number",value:t.account_number,onChange:l,className:`w-full px-3 py-2 border ${a.account_number?"border-red-500":"border-gray-300"} rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500`,placeholder:"Enter account number"}),a.account_number&&e.jsx("div",{className:"text-red-500 text-sm mt-1",children:a.account_number})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Account Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",name:"account_name",value:t.account_name,onChange:l,className:`w-full px-3 py-2 border ${a.account_name?"border-red-500":"border-gray-300"} rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500`,placeholder:"Enter account name"}),a.account_name&&e.jsx("div",{className:"text-red-500 text-sm mt-1",children:a.account_name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Branch"}),e.jsx("input",{type:"text",name:"branch",value:t.branch,onChange:l,className:`w-full px-3 py-2 border ${a.branch?"border-red-500":"border-gray-300"} rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500`,placeholder:"Enter branch name"}),a.branch&&e.jsx("div",{className:"text-red-500 text-sm mt-1",children:a.branch})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2 flex items-center",children:[e.jsx("span",{children:"Bank Logo"}),e.jsx("span",{className:"ml-2 text-red-500 text-xs font-normal",children:"(Optional)"})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:`w-24 h-24 border-2 border-dashed ${a.logo?"border-red-400 bg-red-50":"border-gray-300"} rounded-full flex items-center justify-center overflow-hidden`,children:k?e.jsx("img",{src:k,alt:"Preview",className:"w-full h-full object-cover"}):e.jsxs("div",{className:"text-center",children:[e.jsx(D,{className:"w-8 h-8 text-gray-400 mx-auto"}),!i&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Optional"})]})}),e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsx("input",{type:"file",name:"logo",id:"logo-upload",ref:w,accept:"image/jpeg,image/png,image/gif,image/jpg",onChange:l,className:"hidden"}),e.jsxs("button",{type:"button",onClick:()=>w.current.click(),className:"px-4 py-2 bg-gray-100 border border-gray-300 rounded-md hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-500 inline-flex items-center",children:[e.jsx(V,{className:"w-4 h-4 mr-2"}),"Browse Logo"]}),t.logo instanceof File&&e.jsxs("p",{className:"text-xs text-gray-500",children:["Selected: ",t.logo.name]})]})]}),a.logo&&e.jsx("div",{className:"text-red-500 text-sm mt-1",children:a.logo})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),e.jsx("textarea",{name:"description",value:t.description,onChange:l,className:`w-full px-3 py-2 border ${a.description?"border-red-500":"border-gray-300"} rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500`,rows:"3",placeholder:"Optional description"}),a.description&&e.jsx("div",{className:"text-red-500 text-sm mt-1",children:a.description})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"is_active",name:"is_active",checked:t.is_active,onChange:l,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("label",{htmlFor:"is_active",className:"ml-2 block text-sm text-gray-700",children:"Active"})]})]})}),e.jsx("div",{className:"p-6 border-t border-gray-200 sticky bottom-0 bg-white rounded-b-xl z-10",children:e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsxs("button",{type:"button",onClick:()=>p(!1),className:"px-4 py-2 text-gray-600 hover:bg-gray-100 rounded-md inline-flex items-center",children:[e.jsx(F,{className:"w-4 h-4 mr-2"}),"Cancel"]}),e.jsxs("button",{type:"submit",form:"bankForm",disabled:E||C,className:"px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-70 disabled:cursor-not-allowed inline-flex items-center",children:[e.jsx(W,{className:"w-4 h-4 mr-2"}),C?"Uploading...":E?"Processing...":i?"Update":"Add"]})]})})]})})]})};export{ie as default};
