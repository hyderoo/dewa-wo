import{r,b as h,j as e,f as z}from"./app-Bs2T8Cel.js";import W from"./DatePickerDialog-CQv0Zdkk.js";import{X as Y}from"./x-C6So-ddW.js";import{S as J}from"./search-DK9GOSMe.js";import{L as F}from"./loader-CpXI7Ybk.js";import{C as X}from"./calendar-fqGNGd38.js";import{C as G}from"./circle-alert-Cj8kEujd.js";import"./chevron-left-CNB4_brN.js";import"./createLucideIcon-CvzI4D8G.js";import"./chevron-right-CQJsjOc3.js";const re=({isOpen:m,onClose:g,auth:n})=>{const[P,A]=r.useState([]),[f,b]=r.useState(!0),[N,w]=r.useState(""),[i,j]=r.useState([]),[s,u]=r.useState({client_name:"",event_date:"",venue:"",venue_address:"",estimated_guests:"",email:n!=null&&n.user?n.user.email:"",phone:n!=null&&n.user?n.user.phone:"",alt_phone:"",custom_features:[]}),[l,_]=r.useState({}),[I,L]=r.useState([]),[v,D]=r.useState(!1),[o,c]=r.useState(""),[T,S]=r.useState(!1),[C,x]=r.useState(!1);r.useEffect(()=>{(async()=>{try{const t=await h.get(route("api.booked-dates"));L(t.data.bookedDates)}catch(t){console.error("Error fetching booked dates:",t)}})()},[]),r.useEffect(()=>{m&&f&&h.get("/api/v1/catalogs/custom-features").then(a=>{A(a.data.data.features),b(!1)}).catch(a=>{console.error("Error loading features:",a),b(!1)})},[m,f]),r.useEffect(()=>{m||(w(""),j([]),u({client_name:"",event_date:"",venue:"",venue_address:"",estimated_guests:"",email:n!=null&&n.user?n.user.email:"",phone:n!=null&&n.user?n.user.phone:"",alt_phone:"",custom_features:[]}),_({}),c(""),x(!1),b(!0))},[m,n]),r.useEffect(()=>{u(a=>({...a,custom_features:i.map(t=>t.id)}))},[i]);const E=P.filter(a=>a.name.toLowerCase().includes(N.toLowerCase())),B=a=>{i.find(t=>t.id===a.id)?j(i.filter(t=>t.id!==a.id)):j([...i,a])},y=a=>a?new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(a):"",d=a=>{const{name:t,value:p}=a.target;u({...s,[t]:p})},M=a=>{c(""),D(!0),h.get(route("api.check-date-availability",{date:a})).then(t=>{t.data.available||c("Maaf, tanggal ini sudah dipesan. Silakan pilih tanggal lain."),u({...s,event_date:a})}).catch(t=>{console.error("Error checking date availability:",t),c("Terjadi kesalahan saat memeriksa ketersediaan. Silakan coba lagi.")}).finally(()=>{D(!1)})},q=a=>{a.preventDefault(),S(!0)},K=a=>{if(a.preventDefault(),!s.event_date){c("Tanggal pernikahan harus diisi.");return}if(!o){if(i.length===0){alert("Silakan pilih minimal satu fitur untuk paket kustom Anda.");return}x(!0),h.get(route("api.check-date-availability",{date:s.event_date})).then(t=>{if(!t.data.available){c("Maaf, tanggal ini baru saja dipesan. Silakan pilih tanggal lain."),x(!1);return}const p=i.reduce((k,R)=>k+parseFloat(R.price),0),H={client_name:s.client_name,event_date:s.event_date,venue:s.venue+(s.venue_address?` - ${s.venue_address}`:""),estimated_guests:s.estimated_guests,email:s.email,phone:s.phone,alt_phone:s.alt_phone||null,custom_features:s.custom_features,price:p,original_price:p};z.post(route("custom.store"),H,{onSuccess:()=>{g()},onError:k=>{_(k),x(!1)}})}).catch(t=>{console.error("Error checking date availability:",t),x(!1)})}},$=a=>a?new Date(a).toLocaleDateString("id-ID",{day:"numeric",month:"long",year:"numeric"}):"";return m?e.jsxs("div",{className:"fixed inset-0 bg-black text-gray-800 bg-opacity-50 z-50 flex items-center justify-center p-4 overflow-y-auto",children:[e.jsxs("div",{className:"relative w-full max-w-4xl max-h-[90vh] bg-white rounded-lg overflow-hidden shadow-2xl",children:[e.jsx("button",{onClick:g,className:"absolute top-4 right-4 bg-gray-200 rounded-full p-2 z-10 hover:bg-gray-300 transition",children:e.jsx(Y,{className:"w-6 h-6 text-gray-700"})}),e.jsxs("div",{className:"flex flex-col md:flex-row h-full max-h-[85vh]",children:[e.jsxs("div",{className:"w-full md:w-1/2 bg-pink-50 p-6 md:p-8 overflow-y-auto",children:[e.jsx("h2",{className:"text-2xl font-semibold text-black mb-6",children:"Buat Paket Kustom Anda"}),e.jsxs("div",{className:"relative mb-4",children:[e.jsx("input",{type:"text",placeholder:"Cari fitur...",value:N,onChange:a=>w(a.target.value),className:"w-full px-4 py-2 pl-10 border rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-500"}),e.jsx(J,{className:"w-5 h-5 text-gray-400 absolute left-3 top-2.5"})]}),e.jsxs("div",{className:"space-y-3 mb-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-700 mb-3",children:"Pilih Fitur Yang Anda Inginkan"}),f?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(F,{className:"h-8 w-8 text-pink-500 animate-spin"}),e.jsx("p",{className:"mt-2 text-gray-500",children:"Memuat fitur..."})]})}):E.length>0?E.map(a=>e.jsx("div",{className:`bg-white p-4 rounded-lg shadow-sm cursor-pointer transition ${i.find(t=>t.id===a.id)?"border-2 border-pink-500":"border border-gray-200"}`,onClick:()=>B(a),children:e.jsx("div",{className:"flex justify-between items-start",children:e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-800",children:a.name}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:a.description})]})})},a.id)):e.jsx("p",{className:"text-gray-500 text-center py-4",children:"Tidak ada fitur yang ditemukan"})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-2",children:"Fitur Yang Dipilih"}),i.length===0?e.jsx("p",{className:"text-gray-500 text-sm",children:"Belum ada fitur yang dipilih"}):e.jsx("div",{className:"space-y-2",children:i.map(a=>e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-700",children:a.name}),e.jsx("span",{className:"text-pink-600",children:y(a.price)})]},a.id))})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-2",children:"Estimasi Total"}),e.jsx("p",{className:"text-2xl font-bold text-pink-600",children:y(i.reduce((a,t)=>a+parseFloat(t.price),0))}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Harga ini merupakan estimasi awal. Setelah pemesanan, tim kami akan menghubungi Anda untuk konfirmasi dan detail selanjutnya."})]})]}),e.jsxs("div",{className:"w-full md:w-1/2 p-6 md:p-8 overflow-y-auto",children:[e.jsx("h3",{className:"text-xl md:text-2xl font-semibold mb-4 md:mb-6 text-center",children:"Form Pemesanan"}),e.jsxs("form",{className:"space-y-3 md:space-y-4",onSubmit:K,children:[e.jsxs("div",{className:"border-b pb-4 mb-4",children:[e.jsx("h4",{className:"text-lg font-semibold mb-3",children:"Informasi Klien"}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-gray-700 mb-1 text-sm",children:["Nama Klien (Pasangan) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",name:"client_name",value:s.client_name,onChange:d,placeholder:"Contoh: Budi & Ani",required:!0,className:"w-full px-3 py-2 border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-pink-500"}),l.client_name&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.client_name})]})]}),e.jsxs("div",{className:"border-b pb-4 mb-4",children:[e.jsx("h4",{className:"text-lg font-semibold mb-3",children:"Informasi Acara"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-gray-700 mb-1 text-sm",children:["Tanggal Pernikahan ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("button",{type:"button",onClick:q,className:`
                                                w-full px-3 py-2 border rounded-md text-sm
                                                focus:outline-none focus:ring-2 text-left
                                                flex items-center justify-between relative
                                                ${o?"border-red-300 focus:ring-red-500":"focus:ring-pink-500"}
                                                ${s.event_date?"text-gray-900":"text-gray-500"}
                                            `,children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(X,{className:"h-4 w-4 text-gray-400 mr-2"}),e.jsx("span",{children:s.event_date?$(s.event_date):"Pilih tanggal pernikahan"})]}),e.jsx("svg",{className:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 9l4-4 4 4m0 6l-4 4-4-4"})}),v&&e.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none",children:e.jsx(F,{className:"h-4 w-4 text-gray-400 animate-spin"})})]}),e.jsx("input",{type:"hidden",name:"event_date",value:s.event_date||"",required:!0}),o&&e.jsxs("div",{className:"mt-1 flex items-center text-red-500 text-xs",children:[e.jsx(G,{className:"h-3 w-3 mr-1 flex-shrink-0"}),e.jsx("span",{children:o})]}),l.event_date&&!o&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.event_date})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-gray-700 mb-1 text-sm",children:["Estimasi Jumlah Tamu ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"number",name:"estimated_guests",value:s.estimated_guests,onChange:d,placeholder:"Masukkan perkiraan jumlah tamu",required:!0,className:"w-full px-3 py-2 border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-pink-500"}),l.estimated_guests&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.estimated_guests})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 mb-1 text-sm",children:"Lokasi Acara"}),e.jsx("input",{type:"text",name:"venue",value:s.venue,onChange:d,placeholder:"Nama gedung/tempat acara",className:"w-full px-3 py-2 border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-pink-500 mb-2"}),l.venue&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.venue}),e.jsx("textarea",{name:"venue_address",value:s.venue_address,onChange:d,placeholder:"Alamat lengkap lokasi",rows:2,className:"w-full px-3 py-2 border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-pink-500"})]})]})]}),e.jsxs("div",{className:"border-b pb-4 mb-4",children:[e.jsx("h4",{className:"text-lg font-semibold mb-3",children:"Informasi Kontak"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-gray-700 mb-1 text-sm",children:["Email ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"email",name:"email",value:s.email,onChange:d,required:!0,className:"w-full px-3 py-2 border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-pink-500"}),l.email&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.email})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-gray-700 mb-1 text-sm",children:["Nomor WhatsApp ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"tel",name:"phone",value:s.phone,onChange:d,required:!0,className:"w-full px-3 py-2 border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-pink-500"}),l.phone&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.phone})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-gray-700 mb-1 text-sm",children:["Nomor Telepon Alternatif ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"tel",name:"alt_phone",value:s.alt_phone,onChange:d,className:"w-full px-3 py-2 border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-pink-500"})]})]})]}),e.jsxs("div",{className:"border-b pb-4 mb-4",children:[e.jsx("h4",{className:"text-lg font-semibold mb-3",children:"Informasi Harga"}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Total Paket Kustom:"}),e.jsx("span",{className:"font-semibold text-pink-600",children:y(i.reduce((a,t)=>a+parseFloat(t.price),0))})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Harga ini merupakan estimasi awal berdasarkan fitur yang dipilih. Setelah pemesanan, tim kami akan menghubungi Anda untuk konfirmasi dan detail selanjutnya."})]})]}),e.jsxs("div",{className:"flex justify-between space-x-4 pt-4",children:[e.jsx("button",{type:"button",onClick:g,className:"w-full bg-gray-200 text-gray-700 px-4 py-2 rounded-md text-sm hover:bg-gray-300 transition",children:"Batal"}),e.jsx("button",{type:"submit",disabled:C||o!==""||v||!s.event_date||i.length===0,className:"w-full bg-pink-600 text-white px-4 py-2 rounded-md text-sm hover:bg-pink-700 transition disabled:bg-pink-400 disabled:cursor-not-allowed",children:C?"Memproses...":"Pesan Sekarang"})]})]})]})]})]}),e.jsx(W,{isOpen:T,onClose:()=>S(!1),onDateSelect:M,bookedDates:I,initialDate:s.event_date,isCheckingDate:v})]}):null};export{re as default};
