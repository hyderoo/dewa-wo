import{q as $,r as l,j as e,a as L,J as M,f as P}from"./app-Bj-2ttWe.js";import{A}from"./AdminLayout-C9KiesPq.js";import{T as J}from"./Toast-0AKSzmFv.js";import{C as f}from"./circle-x-BZ6o9ve8.js";import{E}from"./external-link-Cc80ljIz.js";import{C as N}from"./circle-check-big-3DSExcF6.js";import{L as z}from"./loader-circle-1J1U9OfI.js";import{S as D}from"./search-CxmgQfz-.js";import{F as O}from"./funnel-D9_HO87W.js";import{C as F}from"./clock-CluEfeiJ.js";import{C as R}from"./chevron-left-Dic_PlZf.js";import{C as q}from"./chevron-right-CIgsXY0k.js";import"./createLucideIcon-Q6M-lg5u.js";import"./circle-alert-DbwOTSu0.js";import"./eye-off-eoUXuo7G.js";import"./eye-BR07TQjy.js";import"./log-out-DiVVTNjJ.js";import"./x-P4FUM78l.js";import"./chevron-down-BOcF8omZ.js";import"./key-round-BKENG61x.js";import"./users-Dpajf5mq.js";import"./image-B3SenHd_.js";import"./star-IVzQzElw.js";import"./file-text-BGbz3DAs.js";import"./building-C3Qd_UEZ.js";import"./credit-card-UvNpbFda.js";const pe=()=>{const{payments:o,pagination:a,toast:v}=$().props,[S,x]=l.useState(!!v),[w,k]=l.useState(v||{type:"",message:""}),[i,_]=l.useState(null),[m,g]=l.useState(null),[u,n]=l.useState(null),[r,h]=l.useState("verified"),[d,p]=l.useState(""),[b,y]=l.useState(!1),c=s=>{P.get(route("admin.payments.verification"),{page:s},{preserveState:!0,replace:!0})},T=s=>{_(s),h("verified"),p("")},j=()=>{_(null),h("verified"),p("")},C=s=>{h(s)},V=()=>{if(!i)return;y(!0);const s={status:r,note:r==="rejected"?d:""};P.patch(route("admin.payments.verify",i.id),s,{onSuccess:()=>{y(!1),j(),g(null),k({type:"success",message:r==="verified"?"Pembayaran berhasil diverifikasi!":"Pembayaran berhasil ditolak!"}),x(!0)},onError:()=>{y(!1),k({type:"error",message:"Gagal memproses pembayaran. Silakan coba lagi."}),x(!0)}})};return e.jsxs(A,{activeMenu:"payment-verification",children:[e.jsx(L,{title:"Verifikasi Pembayaran"}),S&&e.jsx(J,{type:w.type,message:w.message,onClose:()=>x(!1)}),u&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto p-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Bukti Pembayaran"}),e.jsx("button",{onClick:()=>n(null),className:"text-gray-500 hover:text-gray-700",children:e.jsx(f,{className:"h-6 w-6"})})]}),e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("img",{src:u,alt:"Bukti Pembayaran",className:"max-w-full max-h-[70vh] object-contain"})}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsxs("a",{href:u,target:"_blank",className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:[e.jsx(E,{className:"h-4 w-4 mr-2"}),"Buka di Tab Baru"]}),e.jsx("button",{onClick:()=>n(null),className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300",children:"Tutup"})]})]})}),i&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-lg w-full p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Verifikasi Pembayaran"}),e.jsx("button",{onClick:j,className:"text-gray-500 hover:text-gray-700",children:e.jsx(f,{className:"h-5 w-5"})})]}),e.jsx("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 text-sm",children:"Order Number"}),e.jsx("p",{className:"font-medium",children:i.order_number})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 text-sm",children:"Client"}),e.jsx("p",{className:"font-medium",children:i.client_name})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 text-sm",children:"Jumlah"}),e.jsx("p",{className:"font-medium text-green-600",children:i.amount})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 text-sm",children:"Tanggal"}),e.jsx("p",{className:"font-medium",children:i.created_at})]})]})}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-md font-medium mb-2",children:"Bukti Pembayaran"}),e.jsx("div",{className:"bg-gray-50 p-4 rounded-lg flex justify-center",children:e.jsx("img",{src:i.payment_proof_url,alt:"Bukti Pembayaran",className:"max-h-48 object-contain cursor-pointer",onClick:()=>n(i.payment_proof_url)})}),e.jsx("div",{className:"mt-2 text-center",children:e.jsx("button",{onClick:()=>n(i.payment_proof_url),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Lihat Gambar Lengkap"})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status Pembayaran"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("button",{type:"button",onClick:()=>C("verified"),className:`py-2 px-4 rounded-lg border flex items-center justify-center ${r==="verified"?"bg-green-600 text-white border-green-600":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:[e.jsx(N,{className:"w-4 h-4 mr-2"}),"Verifikasi"]}),e.jsxs("button",{type:"button",onClick:()=>C("rejected"),className:`py-2 px-4 rounded-lg border flex items-center justify-center ${r==="rejected"?"bg-red-600 text-white border-red-600":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:[e.jsx(f,{className:"w-4 h-4 mr-2"}),"Tolak"]})]})]}),r==="rejected"&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Alasan Penolakan ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{value:d,onChange:s=>p(s.target.value),className:"w-full border border-gray-300 rounded-lg p-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Jelaskan alasan penolakan pembayaran ini",rows:"3",required:!0}),r==="rejected"&&!d&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:"Alasan penolakan wajib diisi"})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:j,className:"py-2 px-4 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Batal"}),e.jsx("button",{type:"button",onClick:V,disabled:b||r==="rejected"&&!d,className:`py-2 px-4 rounded-lg text-white ${r==="verified"?"bg-green-600 hover:bg-green-700":"bg-red-600 hover:bg-red-700"} ${b||r==="rejected"&&!d?"opacity-70 cursor-not-allowed":""}`,children:b?e.jsxs("span",{className:"flex items-center",children:[e.jsx(z,{className:"h-4 w-4 mr-2 animate-spin"}),"Memproses..."]}):r==="verified"?"Verifikasi Pembayaran":"Tolak Pembayaran"})]})]})}),e.jsxs("div",{className:"py-6 px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Verifikasi Pembayaran"}),e.jsx("p",{className:"text-gray-600",children:"Verifikasi pembayaran manual yang dilakukan oleh pelanggan"})]}),e.jsxs("div",{className:"bg-white shadow-lg rounded-lg overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center gap-4",children:[e.jsxs("div",{className:"w-full md:w-auto relative",children:[e.jsx(D,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Cari pembayaran...",className:"w-full md:w-80 pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),e.jsx("div",{className:"flex space-x-2",children:e.jsxs("button",{className:"px-4 py-2 flex items-center space-x-1 rounded-lg border border-gray-300 hover:bg-gray-50",children:[e.jsx(O,{className:"w-4 h-4"}),e.jsx("span",{children:"Filter"})]})})]})}),o&&o.length>0?e.jsx("div",{className:"divide-y divide-gray-200",children:o.map(s=>e.jsxs("div",{className:`p-4 hover:bg-gray-50 ${m===s.id?"bg-gray-50":""}`,children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between",children:[e.jsx("div",{className:"flex-grow",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"p-2 bg-yellow-100 rounded-full mr-4",children:e.jsx(F,{className:"h-6 w-6 text-yellow-600"})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900",children:[s.client_name," ",e.jsxs("span",{className:"text-sm text-gray-500",children:["(",s.order_number,")"]})]}),e.jsxs("p",{className:"text-gray-500",children:[s.payment_type," - ",s.amount]}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Dibuat: ",s.created_at]})]})]})}),e.jsxs("div",{className:"flex items-center space-x-3 mt-4 md:mt-0",children:[e.jsx("button",{onClick:()=>n(s.payment_proof_url),className:"px-3 py-1 bg-blue-600 text-white text-sm rounded-md hover:bg-blue-700",children:"Lihat Bukti"}),e.jsx("button",{onClick:()=>{m===s.id?g(null):g(s.id)},className:"px-3 py-1 bg-gray-100 text-gray-700 text-sm rounded-md hover:bg-gray-200",children:m===s.id?"Tutup":"Detail"})]})]}),m===s.id&&e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Detail Pembayaran"}),e.jsx("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Order Number"}),e.jsx("p",{className:"font-medium",children:s.order_number})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Client"}),e.jsx("p",{className:"font-medium",children:s.client_name})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Dibayar Oleh"}),e.jsx("p",{className:"font-medium",children:s.user_name})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Jumlah"}),e.jsx("p",{className:"font-medium",children:s.amount})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Jenis Pembayaran"}),e.jsx("p",{className:"font-medium",children:s.payment_type})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Tanggal Pembayaran"}),e.jsx("p",{className:"font-medium",children:s.created_at})]})]})})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Bukti Pembayaran"}),e.jsx("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200 flex justify-center",children:e.jsx("img",{src:s.payment_proof_url,alt:"Bukti Pembayaran",className:"max-h-48 object-contain cursor-pointer",onClick:()=>n(s.payment_proof_url)})}),e.jsxs("div",{className:"mt-4 flex justify-end space-x-3",children:[e.jsxs("button",{onClick:()=>T(s),className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 flex items-center",children:[e.jsx(N,{className:"h-4 w-4 mr-2"}),"Verifikasi Pembayaran"]}),e.jsx(M,{href:route("admin.payments.history",s.order_id),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Lihat Order"})]})]})]})})]},s.id))}):e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(N,{className:"h-12 w-12 text-green-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-1",children:"Tidak Ada Pembayaran Tertunda"}),e.jsx("p",{className:"text-gray-500",children:"Semua pembayaran telah diverifikasi. Tidak ada pembayaran yang perlu diverifikasi."})]}),a&&a.total>0&&e.jsxs("div",{className:"px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6",children:[e.jsxs("div",{className:"flex-1 flex justify-between sm:hidden",children:[e.jsx("button",{onClick:()=>c(a.current_page-1),disabled:a.current_page===1,className:`relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md ${a.current_page===1?"bg-gray-100 text-gray-400 cursor-default":"bg-white text-gray-700 hover:bg-gray-50"}`,children:"Previous"}),e.jsx("button",{onClick:()=>c(a.current_page+1),disabled:a.current_page===a.last_page,className:`ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md ${a.current_page===a.last_page?"bg-gray-100 text-gray-400 cursor-default":"bg-white text-gray-700 hover:bg-gray-50"}`,children:"Next"})]}),e.jsxs("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[e.jsx("div",{children:e.jsxs("p",{className:"text-sm text-gray-700",children:["Showing ",e.jsx("span",{className:"font-medium",children:a.from})," to"," ",e.jsx("span",{className:"font-medium",children:a.to})," of"," ",e.jsx("span",{className:"font-medium",children:a.total})," results"]})}),e.jsx("div",{children:e.jsxs("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination",children:[e.jsxs("button",{onClick:()=>c(a.current_page-1),disabled:a.current_page===1,className:`relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium ${a.current_page===1?"text-gray-300 cursor-default":"text-gray-500 hover:bg-gray-50"}`,children:[e.jsx("span",{className:"sr-only",children:"Previous"}),e.jsx(R,{className:"h-5 w-5","aria-hidden":"true"})]}),[...Array(a.last_page)].map((s,B)=>{const t=B+1;return t===1||t===a.last_page||Math.abs(t-a.current_page)<=1?e.jsx("button",{onClick:()=>c(t),"aria-current":t===a.current_page?"page":void 0,className:`relative inline-flex items-center px-4 py-2 border text-sm font-medium ${t===a.current_page?"z-10 bg-indigo-50 border-indigo-500 text-indigo-600":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50"}`,children:t},t):t===2&&a.current_page>3||t===a.last_page-1&&a.current_page<a.last_page-2?e.jsx("span",{className:"relative inline-flex items-center px-4 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-700",children:"..."},t):null}),e.jsxs("button",{onClick:()=>c(a.current_page+1),disabled:a.current_page===a.last_page,className:`relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium ${a.current_page===a.last_page?"text-gray-300 cursor-default":"text-gray-500 hover:bg-gray-50"}`,children:[e.jsx("span",{className:"sr-only",children:"Next"}),e.jsx(q,{className:"h-5 w-5","aria-hidden":"true"})]})]})})]})]})]})]})]})};export{pe as default};
